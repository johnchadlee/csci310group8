package csci310.weatherplanner.weathersource;

import static org.junit.Assert.*;

import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;


import org.junit.BeforeClass;
import org.junit.Test;

import csci310.weatherplanner.weathersource.mock.MockExternalAPI;

public class AerisSimpleForecastSourceTest {
	private static IExternalAPI mockAPI;
	private static AerisSimpleForecastSource testForecastSource;
	
	@BeforeClass
	public static void setUp() throws Exception {
		Map<String, String> endpointMap = new HashMap<String, String>();
		endpointMap.put("/observations/closest", "{\"success\":true,\"error\":null,\"response\":[{\"id\":\"KFTY\",\"loc\":{\"long\":-84.516666666667,\"lat\":33.783333333333},\"place\":{\"name\":\"atlanta\\/fulton\",\"city\":\"atlanta\\/fulton\",\"state\":\"ga\",\"country\":\"us\"},\"profile\":{\"tz\":\"America\\/New_York\",\"tzname\":\"EDT\",\"tzoffset\":-14400,\"isDST\":true,\"elevM\":263,\"elevFT\":863},\"obTimestamp\":1583891580,\"obDateTime\":\"2020-03-10T21:53:00-04:00\",\"ob\":{\"type\":\"station\",\"timestamp\":1583891580,\"dateTimeISO\":\"2020-03-10T21:53:00-04:00\",\"recTimestamp\":1583891880,\"recDateTimeISO\":\"2020-03-10T21:58:00-04:00\",\"tempC\":13.9,\"tempF\":57,\"dewpointC\":12.2,\"dewpointF\":54,\"humidity\":90,\"pressureMB\":1024,\"pressureIN\":30.23,\"spressureMB\":992,\"spressureIN\":29.31,\"altimeterMB\":1024,\"altimeterIN\":30.24,\"windKTS\":3,\"windKPH\":6,\"windMPH\":3,\"windSpeedKTS\":3,\"windSpeedKPH\":6,\"windSpeedMPH\":3,\"windDirDEG\":150,\"windDir\":\"SSE\",\"windGustKTS\":null,\"windGustKPH\":null,\"windGustMPH\":null,\"flightRule\":\"VFR\",\"visibilityKM\":16.0934,\"visibilityMI\":10,\"weather\":\"Clear\",\"weatherShort\":\"Clear\",\"weatherCoded\":\"::CL\",\"weatherPrimary\":\"Clear\",\"weatherPrimaryCoded\":\"::CL\",\"cloudsCoded\":\"CL\",\"icon\":\"clearn.png\",\"heatindexC\":14,\"heatindexF\":57,\"windchillC\":14,\"windchillF\":57,\"feelslikeC\":14,\"feelslikeF\":57,\"isDay\":false,\"sunrise\":1583841239,\"sunriseISO\":\"2020-03-10T07:53:59-04:00\",\"sunset\":1583883737,\"sunsetISO\":\"2020-03-10T19:42:17-04:00\",\"snowDepthCM\":null,\"snowDepthIN\":null,\"precipMM\":0,\"precipIN\":0,\"solradWM2\":0,\"solradMethod\":\"estimated\",\"ceilingFT\":null,\"ceilingM\":null,\"light\":0,\"uvi\":null,\"QC\":\"O\",\"QCcode\":10,\"trustFactor\":100,\"sky\":0},\"raw\":\"METAR KFTY 110153Z 15003KT 10SM CLR 14\\/12 A3024 RMK AO2 SLP237 T01390122\",\"relativeTo\":{\"lat\":33.755,\"long\":-84.39,\"bearing\":285,\"bearingENG\":\"WNW\",\"distanceKM\":12.125,\"distanceMI\":7.534}}]}");
		endpointMap.put("/forecasts/atlanta,us","{\"success\":true,\"error\":{\"code\":\"warn_location\",\"description\":\"No state\\/province provided, using location based on population\"},\"response\":[{\"loc\":{\"long\":-84.39,\"lat\":33.755},\"interval\":\"day\",\"periods\":[{\"timestamp\":1583838000,\"validTime\":\"2020-03-10T07:00:00-04:00\",\"dateTimeISO\":\"2020-03-10T07:00:00-04:00\",\"maxTempC\":19,\"maxTempF\":66,\"minTempC\":13,\"minTempF\":55,\"avgTempC\":16,\"avgTempF\":60,\"tempC\":null,\"tempF\":null,\"pop\":65,\"precipMM\":1.19,\"precipIN\":0.05,\"iceaccum\":0,\"iceaccumMM\":0,\"iceaccumIN\":0,\"maxHumidity\":90,\"minHumidity\":67,\"humidity\":75,\"uvi\":3,\"pressureMB\":1027,\"pressureIN\":30.33,\"sky\":83,\"snowCM\":0,\"snowIN\":0,\"feelslikeC\":12,\"feelslikeF\":54,\"minFeelslikeC\":12,\"minFeelslikeF\":54,\"maxFeelslikeC\":18,\"maxFeelslikeF\":65,\"avgFeelslikeC\":16,\"avgFeelslikeF\":60,\"dewpointC\":10,\"dewpointF\":50,\"maxDewpointC\":12,\"maxDewpointF\":54,\"minDewpointC\":10,\"minDewpointF\":50,\"avgDewpointC\":11,\"avgDewpointF\":52,\"windDirDEG\":190,\"windDir\":\"S\",\"windDirMaxDEG\":220,\"windDirMax\":\"SW\",\"windDirMinDEG\":190,\"windDirMin\":\"S\",\"windGustKTS\":15,\"windGustKPH\":28,\"windGustMPH\":17,\"windSpeedKTS\":8,\"windSpeedKPH\":15,\"windSpeedMPH\":10,\"windSpeedMaxKTS\":10,\"windSpeedMaxKPH\":18,\"windSpeedMaxMPH\":11,\"windSpeedMinKTS\":4,\"windSpeedMinKPH\":8,\"windSpeedMinMPH\":5,\"windDir80mDEG\":207,\"windDir80m\":\"SSW\",\"windDirMax80mDEG\":220,\"windDirMax80m\":\"SW\",\"windDirMin80mDEG\":190,\"windDirMin80m\":\"S\",\"windGust80mKTS\":15,\"windGust80mKPH\":28,\"windGust80mMPH\":17,\"windSpeed80mKTS\":12,\"windSpeed80mKPH\":23,\"windSpeed80mMPH\":14,\"windSpeedMax80mKTS\":15,\"windSpeedMax80mKPH\":28,\"windSpeedMax80mMPH\":17,\"windSpeedMin80mKTS\":8,\"windSpeedMin80mKPH\":15,\"windSpeedMin80mMPH\":9,\"weather\":\"Mostly Cloudy with Light Showers\",\"weatherCoded\":[{\"timestamp\":1583845200,\"wx\":\"L:L:RW\",\"dateTimeISO\":\"2020-03-10T09:00:00-04:00\"},{\"timestamp\":1583848800,\"wx\":\"D:L:RW\",\"dateTimeISO\":\"2020-03-10T10:00:00-04:00\"},{\"timestamp\":1583852400,\"wx\":\"L:L:RW\",\"dateTimeISO\":\"2020-03-10T11:00:00-04:00\"},{\"timestamp\":1583856000,\"wx\":\"C:L:RW\",\"dateTimeISO\":\"2020-03-10T12:00:00-04:00\"},{\"timestamp\":1583859600,\"wx\":\"L:L:RW\",\"dateTimeISO\":\"2020-03-10T13:00:00-04:00\"},{\"timestamp\":1583863200,\"wx\":\"C:L:RW\",\"dateTimeISO\":\"2020-03-10T14:00:00-04:00\"},{\"timestamp\":1583874000,\"wx\":\"S:L:RW\",\"dateTimeISO\":\"2020-03-10T17:00:00-04:00\"}],\"weatherPrimary\":\"Showers\",\"weatherPrimaryCoded\":\"D:L:RW\",\"cloudsCoded\":\"BK\",\"icon\":\"showers.png\",\"solradWM2\":3289,\"solradMinWM2\":88,\"solradMaxWM2\":477,\"isDay\":true,\"sunrise\":1583841209,\"sunriseISO\":\"2020-03-10T07:53:29-04:00\",\"sunset\":1583883707,\"sunsetISO\":\"2020-03-10T19:41:47-04:00\"},{\"timestamp\":1583924400,\"validTime\":\"2020-03-11T07:00:00-04:00\",\"dateTimeISO\":\"2020-03-11T07:00:00-04:00\",\"maxTempC\":21,\"maxTempF\":70,\"minTempC\":13,\"minTempF\":55,\"avgTempC\":17,\"avgTempF\":62,\"tempC\":null,\"tempF\":null,\"pop\":28,\"precipMM\":0.51,\"precipIN\":0.02,\"iceaccum\":0,\"iceaccumMM\":0,\"iceaccumIN\":0,\"maxHumidity\":96,\"minHumidity\":68,\"humidity\":76,\"uvi\":4,\"pressureMB\":1020,\"pressureIN\":30.12,\"sky\":72,\"snowCM\":0,\"snowIN\":0,\"feelslikeC\":13,\"feelslikeF\":56,\"minFeelslikeC\":13,\"minFeelslikeF\":56,\"maxFeelslikeC\":21,\"maxFeelslikeF\":69,\"avgFeelslikeC\":18,\"avgFeelslikeF\":64,\"dewpointC\":13,\"dewpointF\":56,\"maxDewpointC\":14,\"maxDewpointF\":57,\"minDewpointC\":12,\"minDewpointF\":53,\"avgDewpointC\":13,\"avgDewpointF\":55,\"windDirDEG\":250,\"windDir\":\"WSW\","
				+ "\"windDirMaxDEG\":280,\"windDirMax\":\"W\",\"windDirMinDEG\":250,\"windDirMin\":\"WSW\",\"windGustKTS\":11,\"windGustKPH\":21,\"windGustMPH\":13,\"windSpeedKTS\":5,\"windSpeedKPH\":10,\"windSpeedMPH\":6,\"windSpeedMaxKTS\":7,\"windSpeedMaxKPH\":13,\"windSpeedMaxMPH\":8,\"windSpeedMinKTS\":3,\"windSpeedMinKPH\":5,\"windSpeedMinMPH\":3,\"windDir80mDEG\":255,\"windDir80m\":\"WSW\",\"windDirMax80mDEG\":280,\"windDirMax80m\":\"W\",\"windDirMin80mDEG\":250,\"windDirMin80m\":\"WSW\",\"windGust80mKTS\":13,\"windGust80mKPH\":25,\"windGust80mMPH\":15,\"windSpeed80mKTS\":9,\"windSpeed80mKPH\":18,\"windSpeed80mMPH\":11,\"windSpeedMax80mKTS\":13,\"windSpeedMax80mKPH\":25,\"windSpeedMax80mMPH\":15,\"windSpeedMin80mKTS\":7,\"windSpeedMin80mKPH\":12,\"windSpeedMin80mMPH\":8,\"weather\":\"Mostly Cloudy with Isolated Showers\",\"weatherCoded\":[{\"timestamp\":1583924400,\"wx\":\"S:L:RW,PA::F\",\"dateTimeISO\":\"2020-03-11T07:00:00-04:00\"},{\"timestamp\":1583931600,\"wx\":\"S:L:RW\",\"dateTimeISO\":\"2020-03-11T09:00:00-04:00\"},{\"timestamp\":1583953200,\"wx\":\"S::T,S:L:RW\",\"dateTimeISO\":\"2020-03-11T15:00:00-04:00\"}],\"weatherPrimary\":\"Isolated Showers\",\"weatherPrimaryCoded\":\"S:L:RW\",\"cloudsCoded\":\"BK\",\"icon\":\"mcloudyr.png\",\"solradWM2\":4152,\"solradMinWM2\":141,\"solradMaxWM2\":633,\"isDay\":true,\"sunrise\":1583927529,\"sunriseISO\":\"2020-03-11T07:52:09-04:00\",\"sunset\":1583970154,\"sunsetISO\":\"2020-03-11T19:42:34-04:00\"},{\"timestamp\":1584010800,\"validTime\":\"2020-03-12T07:00:00-04:00\",\"dateTimeISO\":\"2020-03-12T07:00:00-04:00\",\"maxTempC\":22,\"maxTempF\":71,\"minTempC\":15,\"minTempF\":59,\"avgTempC\":18,\"avgTempF\":64,\"tempC\":null,\"tempF\":null,\"pop\":42,\"precipMM\":1.69,\"precipIN\":0.07,\"iceaccum\":0,\"iceaccumMM\":0,\"iceaccumIN\":0,\"maxHumidity\":97,\"minHumidity\":57,\"humidity\":75,\"uvi\":4,\"pressureMB\":1015,\"pressureIN\":29.97,\"sky\":83,\"snowCM\":0,\"snowIN\":0,\"feelslikeC\":13,\"feelslikeF\":55,\"minFeelslikeC\":13,\"minFeelslikeF\":55,\"maxFeelslikeC\":22,\"maxFeelslikeF\":71,\"avgFeelslikeC\":17,\"avgFeelslikeF\":63,\"dewpointC\":13,\"dewpointF\":55,\"maxDewpointC\":13,\"maxDewpointF\":56,\"minDewpointC\":12,\"minDewpointF\":54,\"avgDewpointC\":13,\"avgDewpointF\":55,\"windDirDEG\":200,\"windDir\":\"SSW\",\"windDirMaxDEG\":210,\"windDirMax\":\"SSW\",\"windDirMinDEG\":170,\"windDirMin\":\"S\",\"windGustKTS\":11,\"windGustKPH\":21,\"windGustMPH\":13,\"windSpeedKTS\":5,\"windSpeedKPH\":10,\"windSpeedMPH\":6,\"windSpeedMaxKTS\":7,\"windSpeedMaxKPH\":13,\"windSpeedMaxMPH\":8,\"windSpeedMinKTS\":3,\"windSpeedMinKPH\":5,\"windSpeedMinMPH\":3,\"windDir80mDEG\":216,\"windDir80m\":\"SW\",\"windDirMax80mDEG\":210,\"windDirMax80m\":\"SSW\",\"windDirMin80mDEG\":170,\"windDirMin80m\":\"S\",\"windGust80mKTS\":12,\"windGust80mKPH\":22,\"windGust80mMPH\":14,\"windSpeed80mKTS\":10,\"windSpeed80mKPH\":18,\"windSpeed80mMPH\":11,\"windSpeedMax80mKTS\":12,\"windSpeedMax80mKPH\":22,\"windSpeedMax80mMPH\":14,\"windSpeedMin80mKTS\":7,\"windSpeedMin80mKPH\":13,\"windSpeedMin80mMPH\":8,\"weather\":\"Mostly Cloudy with Scattered Showers\",\"weatherCoded\":[{\"timestamp\":1584010800,\"wx\":\"C:L:RW,S::T\",\"dateTimeISO\":\"2020-03-12T07:00:00-04:00\"},{\"timestamp\":1584014400,\"wx\":\"C:L:RW\",\"dateTimeISO\":\"2020-03-12T08:00:00-04:00\"},{\"timestamp\":1584036000,\"wx\":\"C:L:RW,S::T\",\"dateTimeISO\":\"2020-03-12T14:00:00-04:00\"}],\"weatherPrimary\":\"Scattered Showers\",\"weatherPrimaryCoded\":\"C:L:RW\",\"cloudsCoded\":\"BK\",\"icon\":\"mcloudyr.png\",\"solradWM2\":3270,\"solradMinWM2\":100,\"solradMaxWM2\":482,\"isDay\":true,\"sunrise\":1584013850,\"sunriseISO\":\"2020-03-12T07:50:50-04:00\",\"sunset\":1584056601,\"sunsetISO\":\"2020-03-12T19:43:21-04:00\"},{\"timestamp\":1584097200,\"validTime\":\"2020-03-13T07:00:00-04:00\",\"dateTimeISO\":\"2020-03-13T07:00:00-04:00\",\"maxTempC\":21,\"maxTempF\":69,\"minTempC\":12,\"minTempF\":53,\"avgTempC\":16,\"avgTempF\":60,\"tempC\":null,\"tempF\":null,\"pop\":58,\"precipMM\":2.95,\"precipIN\":0.12,\"iceaccum\":0,\"iceaccumMM\":0,\"iceaccumIN\":0,\"maxHumidity\":97,\"minHumidity\":59,\"humidity\":77,\"uvi\":5,\"pressureMB\":1019,\"pressureIN\":30.09,\"sky\":86,\"snowCM\":0,\"snowIN\":0,\"feelslikeC\":15,\"feelslikeF\":59,\"minFeelslikeC\":15,"
				+ "\"minFeelslikeF\":59,\"maxFeelslikeC\":21,\"maxFeelslikeF\":69,\"avgFeelslikeC\":18,\"avgFeelslikeF\":65,\"dewpointC\":14,\"dewpointF\":58,\"maxDewpointC\":14,\"maxDewpointF\":58,\"minDewpointC\":13,\"minDewpointF\":55,\"avgDewpointC\":14,\"avgDewpointF\":57,\"windDirDEG\":240,\"windDir\":\"WSW\",\"windDirMaxDEG\":300,\"windDirMax\":\"WNW\",\"windDirMinDEG\":320,\"windDirMin\":\"NW\",\"windGustKTS\":10,\"windGustKPH\":18,\"windGustMPH\":11,\"windSpeedKTS\":6,\"windSpeedKPH\":11,\"windSpeedMPH\":7,\"windSpeedMaxKTS\":6,\"windSpeedMaxKPH\":11,\"windSpeedMaxMPH\":7,\"windSpeedMinKTS\":3,\"windSpeedMinKPH\":5,\"windSpeedMinMPH\":3,\"windDir80mDEG\":254,\"windDir80m\":\"WSW\",\"windDirMax80mDEG\":300,\"windDirMax80m\":\"WNW\",\"windDirMin80mDEG\":320,\"windDirMin80m\":\"NW\",\"windGust80mKTS\":17,\"windGust80mKPH\":32,\"windGust80mMPH\":20,\"windSpeed80mKTS\":11,\"windSpeed80mKPH\":21,\"windSpeed80mMPH\":13,\"windSpeedMax80mKTS\":17,\"windSpeedMax80mKPH\":32,\"windSpeedMax80mMPH\":20,\"windSpeedMin80mKTS\":7,\"windSpeedMin80mKPH\":12,\"windSpeedMin80mMPH\":8,\"weather\":\"Mostly Cloudy with Showers Likely\",\"weatherCoded\":[{\"timestamp\":1584097200,\"wx\":\"C:L:RW\",\"dateTimeISO\":\"2020-03-13T07:00:00-04:00\"},{\"timestamp\":1584100800,\"wx\":\"L::RW\",\"dateTimeISO\":\"2020-03-13T08:00:00-04:00\"}],\"weatherPrimary\":\"Showers\",\"weatherPrimaryCoded\":\"L::RW\",\"cloudsCoded\":\"BK\",\"icon\":\"showers.png\",\"solradWM2\":2972,\"solradMinWM2\":110,\"solradMaxWM2\":408,\"isDay\":true,\"sunrise\":1584100170,\"sunriseISO\":\"2020-03-13T07:49:30-04:00\",\"sunset\":1584143048,\"sunsetISO\":\"2020-03-13T19:44:08-04:00\"},{\"timestamp\":1584183600,\"validTime\":\"2020-03-14T07:00:00-04:00\",\"dateTimeISO\":\"2020-03-14T07:00:00-04:00\",\"maxTempC\":18,\"maxTempF\":64,\"minTempC\":11,\"minTempF\":52,\"avgTempC\":14,\"avgTempF\":57,\"tempC\":null,\"tempF\":null,\"pop\":43,\"precipMM\":4.59,\"precipIN\":0.18,\"iceaccum\":null,\"iceaccumMM\":null,\"iceaccumIN\":null,\"maxHumidity\":81,\"minHumidity\":61,\"humidity\":73,\"uvi\":5,\"pressureMB\":1026,\"pressureIN\":30.3,\"sky\":77,\"snowCM\":0,\"snowIN\":0,\"feelslikeC\":12,\"feelslikeF\":54,\"minFeelslikeC\":12,\"minFeelslikeF\":53,\"maxFeelslikeC\":17,\"maxFeelslikeF\":62,\"avgFeelslikeC\":15,\"avgFeelslikeF\":59,\"dewpointC\":12,\"dewpointF\":53,\"maxDewpointC\":12,\"maxDewpointF\":53,\"minDewpointC\":10,\"minDewpointF\":51,\"avgDewpointC\":11,\"avgDewpointF\":52,\"windDirDEG\":70,\"windDir\":\"ENE\",\"windDirMaxDEG\":100,\"windDirMax\":\"E\",\"windDirMinDEG\":70,\"windDirMin\":\"ENE\",\"windGustKTS\":10,\"windGustKPH\":18,\"windGustMPH\":11,\"windSpeedKTS\":5,\"windSpeedKPH\":9,\"windSpeedMPH\":6,\"windSpeedMaxKTS\":6,\"windSpeedMaxKPH\":11,\"windSpeedMaxMPH\":7,\"windSpeedMinKTS\":2,\"windSpeedMinKPH\":4,\"windSpeedMinMPH\":2,\"windDir80mDEG\":81,\"windDir80m\":\"E\",\"windDirMax80mDEG\":100,\"windDirMax80m\":\"E\",\"windDirMin80mDEG\":70,\"windDirMin80m\":\"ENE\",\"windGust80mKTS\":14,\"windGust80mKPH\":26,\"windGust80mMPH\":16,\"windSpeed80mKTS\":12,\"windSpeed80mKPH\":22,\"windSpeed80mMPH\":14,\"windSpeedMax80mKTS\":14,\"windSpeedMax80mKPH\":26,\"windSpeedMax80mMPH\":16,\"windSpeedMin80mKTS\":10,\"windSpeedMin80mKPH\":18,\"windSpeedMin80mMPH\":11,\"weather\":\"Mostly Cloudy with Scattered Showers\",\"weatherCoded\":[{\"timestamp\":1584183600,\"wx\":\"C:L:RW\",\"dateTimeISO\":\"2020-03-14T07:00:00-04:00\"}],\"weatherPrimary\":\"Scattered Showers\",\"weatherPrimaryCoded\":\"C:L:RW\",\"cloudsCoded\":\"BK\",\"icon\":\"mcloudyr.png\",\"solradWM2\":3995,\"solradMinWM2\":127,\"solradMaxWM2\":598,\"isDay\":true,\"sunrise\":1584186490,\"sunriseISO\":\"2020-03-14T07:48:10-04:00\",\"sunset\":1584229495,\"sunsetISO\":\"2020-03-14T19:44:55-04:00\"},{\"timestamp\":1584270000,\"validTime\":\"2020-03-15T07:00:00-04:00\",\"dateTimeISO\":\"2020-03-15T07:00:00-04:00\",\"maxTempC\":18,\"maxTempF\":64,\"minTempC\":11,\"minTempF\":51,\"avgTempC\":15,\"avgTempF\":58,\"tempC\":null,\"tempF\":null,\"pop\":63,\"precipMM\":17.22,\"precipIN\":0.68,\"iceaccum\":null,\"iceaccumMM\":null,\"iceaccumIN\":null,\"maxHumidity\":96,\"minHumidity\":63,\"humidity\":83,\"uvi\":0,\"pressureMB\":1025,\"pressureIN\":30.27,\"sky\":93,\"snowCM\":0,\"snowIN\":0,\"feelslikeC\":11,\"feelslikeF\":52,\"minFeelslikeC\":11,"
				+ "\"minFeelslikeF\":52,\"maxFeelslikeC\":17,\"maxFeelslikeF\":62,\"avgFeelslikeC\":15,\"avgFeelslikeF\":58,\"dewpointC\":11,\"dewpointF\":51,\"maxDewpointC\":12,\"maxDewpointF\":54,\"minDewpointC\":11,\"minDewpointF\":51,\"avgDewpointC\":12,\"avgDewpointF\":53,\"windDirDEG\":80,\"windDir\":\"E\",\"windDirMaxDEG\":90,\"windDirMax\":\"E\",\"windDirMinDEG\":80,\"windDirMin\":\"E\",\"windGustKTS\":6,\"windGustKPH\":11,\"windGustMPH\":7,\"windSpeedKTS\":3,\"windSpeedKPH\":6,\"windSpeedMPH\":4,\"windSpeedMaxKTS\":6,\"windSpeedMaxKPH\":11,\"windSpeedMaxMPH\":7,\"windSpeedMinKTS\":2,\"windSpeedMinKPH\":4,\"windSpeedMinMPH\":2,\"windDir80mDEG\":97,\"windDir80m\":\"E\",\"windDirMax80mDEG\":90,\"windDirMax80m\":\"E\",\"windDirMin80mDEG\":80,\"windDirMin80m\":\"E\",\"windGust80mKTS\":7,\"windGust80mKPH\":13,\"windGust80mMPH\":8,\"windSpeed80mKTS\":6,\"windSpeed80mKPH\":11,\"windSpeed80mMPH\":7,\"windSpeedMax80mKTS\":7,\"windSpeedMax80mKPH\":13,\"windSpeedMax80mMPH\":8,\"windSpeedMin80mKTS\":5,\"windSpeedMin80mKPH\":8,\"windSpeedMin80mMPH\":5,\"weather\":\"Mostly Cloudy with Showers Likely\",\"weatherCoded\":[{\"timestamp\":1584270000,\"wx\":\"L::RW\",\"dateTimeISO\":\"2020-03-15T07:00:00-04:00\"}],\"weatherPrimary\":\"Showers\",\"weatherPrimaryCoded\":\"L::RW\",\"cloudsCoded\":\"BK\",\"icon\":\"showers.png\",\"solradWM2\":2359,\"solradMinWM2\":75,\"solradMaxWM2\":322,\"isDay\":true,\"sunrise\":1584272810,\"sunriseISO\":\"2020-03-15T07:46:50-04:00\",\"sunset\":1584315941,\"sunsetISO\":\"2020-03-15T19:45:41-04:00\"},{\"timestamp\":1584356400,\"validTime\":\"2020-03-16T07:00:00-04:00\",\"dateTimeISO\":\"2020-03-16T07:00:00-04:00\",\"maxTempC\":16,\"maxTempF\":61,\"minTempC\":11,\"minTempF\":51,\"avgTempC\":14,\"avgTempF\":56,\"tempC\":null,\"tempF\":null,\"pop\":46,\"precipMM\":2.26,\"precipIN\":0.09,\"iceaccum\":null,\"iceaccumMM\":null,\"iceaccumIN\":null,\"maxHumidity\":97,\"minHumidity\":70,\"humidity\":83,\"uvi\":0,\"pressureMB\":1025,\"pressureIN\":30.27,\"sky\":89,\"snowCM\":0,\"snowIN\":0,\"feelslikeC\":11,\"feelslikeF\":51,\"minFeelslikeC\":11,\"minFeelslikeF\":51,\"maxFeelslikeC\":15,\"maxFeelslikeF\":59,\"avgFeelslikeC\":13,\"avgFeelslikeF\":56,\"dewpointC\":10,\"dewpointF\":50,\"maxDewpointC\":11,\"maxDewpointF\":51,\"minDewpointC\":10,\"minDewpointF\":50,\"avgDewpointC\":10,\"avgDewpointF\":51,\"windDirDEG\":90,\"windDir\":\"E\",\"windDirMaxDEG\":100,\"windDirMax\":\"E\",\"windDirMinDEG\":100,\"windDirMin\":\"E\",\"windGustKTS\":11,\"windGustKPH\":21,\"windGustMPH\":13,\"windSpeedKTS\":7,\"windSpeedKPH\":12,\"windSpeedMPH\":8,\"windSpeedMaxKTS\":7,\"windSpeedMaxKPH\":13,\"windSpeedMaxMPH\":8,\"windSpeedMinKTS\":3,\"windSpeedMinKPH\":6,\"windSpeedMinMPH\":4,\"windDir80mDEG\":107,\"windDir80m\":\"ESE\",\"windDirMax80mDEG\":100,\"windDirMax80m\":\"E\",\"windDirMin80mDEG\":100,\"windDirMin80m\":\"E\",\"windGust80mKTS\":13,\"windGust80mKPH\":25,\"windGust80mMPH\":15,\"windSpeed80mKTS\":11,\"windSpeed80mKPH\":20,\"windSpeed80mMPH\":13,\"windSpeedMax80mKTS\":13,\"windSpeedMax80mKPH\":25,\"windSpeedMax80mMPH\":15,\"windSpeedMin80mKTS\":10,\"windSpeedMin80mKPH\":18,\"windSpeedMin80mMPH\":11,\"weather\":\"Mostly Cloudy with Showers Likely\",\"weatherCoded\":[{\"timestamp\":1584356400,\"wx\":\"L::RW,S::T\",\"dateTimeISO\":\"2020-03-16T07:00:00-04:00\"}],\"weatherPrimary\":\"Showers\",\"weatherPrimaryCoded\":\"L::RW\",\"cloudsCoded\":\"BK\",\"icon\":\"showers.png\",\"solradWM2\":2980,\"solradMinWM2\":1,\"solradMaxWM2\":428,\"isDay\":true,\"sunrise\":1584359130,\"sunriseISO\":\"2020-03-16T07:45:30-04:00\",\"sunset\":1584402388,\"sunsetISO\":\"2020-03-16T19:46:28-04:00\"}],\"profile\":{\"tz\":\"America\\/New_York\",\"elevM\":320,\"elevFT\":1050}}]}");
		mockAPI = new MockExternalAPI(endpointMap);
		
		testForecastSource = new AerisSimpleForecastSource(mockAPI);
	}

	@Test
	public void testGetCurrentWeatherSingleLocationFahrenheit() {
		WeatherLocation result = testForecastSource.getCurrentWeather("Atlanta,us", TempUnit.Fahrenheit);
		WeatherLocation expected = new WeatherLocation("atlanta/fulton", "us", "Clear", 
				WeatherIcon.Sunny.getStaticPath(), WeatherIcon.Sunny.getAnimatePath(), -1, -1, 57, TempUnit.Fahrenheit, 0, false);
		assertEquals(expected, result);
	}
	
	@Test
	public void testGetCurrentWeatherSingleLocationCelsius() {
		WeatherLocation result = testForecastSource.getCurrentWeather("Atlanta,us", TempUnit.Celsius);
		WeatherLocation expected = new WeatherLocation("atlanta/fulton", "us", "Clear", 
				WeatherIcon.Sunny.getStaticPath(), WeatherIcon.Sunny.getAnimatePath(), -1, -1, 13, TempUnit.Celsius, 0, false);
		assertEquals(expected, result);
	}

	@Test
	public void testGetCurrentWeatherMultipleLocations() {
		List<String> locations = new ArrayList<String>();
		locations.add("Atlanta,us");
		locations.add("New+York,us");
		
		List<WeatherLocation> result = testForecastSource.getCurrentWeather(locations, TempUnit.Fahrenheit);
	}

	@Test
	public void testGetForecastFahrenheit() {
		String time = "2020-03-10T23:56:23-4:00";
		
		DateFormat isoFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");
		java.util.Date javaDate = null;
		try {
			javaDate = isoFormat.parse(time.substring(0, 19));
		} catch (ParseException e) { }
		
		
		List<DailyForecast> result = testForecastSource.getForecast("atlanta,us", TempUnit.Fahrenheit);
		assertTrue(result.size() >= 5);
		
		List<DailyForecast> expected = new ArrayList<DailyForecast>();
		expected.add(new DailyForecast(new Date(Month.Mar, 2), WeatherIcon.Raining.getStaticPath(), 55, 66, TempUnit.Fahrenheit));
		expected.add(new DailyForecast(new Date(Month.Mar, 3), WeatherIcon.Raining.getStaticPath(), 55, 70, TempUnit.Fahrenheit));
		expected.add(new DailyForecast(new Date(Month.Mar, 4), WeatherIcon.Raining.getStaticPath(), 59, 71, TempUnit.Fahrenheit));
		expected.add(new DailyForecast(new Date(Month.Mar, 5), WeatherIcon.Raining.getStaticPath(), 53, 69, TempUnit.Fahrenheit));
		expected.add(new DailyForecast(new Date(Month.Mar, 6), WeatherIcon.Raining.getStaticPath(), 52, 64, TempUnit.Fahrenheit));
		
		assertEquals(expected, result);
		
	}
	
	@Test
	public void testGetForecastCelcius() {
		String time = "2020-03-10T23:56:23-4:00";
		
		DateFormat isoFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");
		java.util.Date javaDate = null;
		try {
			javaDate = isoFormat.parse(time.substring(0, 19));
		} catch (ParseException e) { }
		
		
		List<DailyForecast> result = testForecastSource.getForecast("atlanta,us", TempUnit.Celsius);
		assertTrue(result.size() >= 5);
		
		List<DailyForecast> expected = new ArrayList<DailyForecast>();
		expected.add(new DailyForecast(new Date(Month.Mar, 2), WeatherIcon.Raining.getStaticPath(), 13, 19, TempUnit.Celsius));
		expected.add(new DailyForecast(new Date(Month.Mar, 3), WeatherIcon.Raining.getStaticPath(), 13, 21, TempUnit.Celsius));
		expected.add(new DailyForecast(new Date(Month.Mar, 4), WeatherIcon.Raining.getStaticPath(), 15, 22, TempUnit.Celsius));
		expected.add(new DailyForecast(new Date(Month.Mar, 5), WeatherIcon.Raining.getStaticPath(), 12, 21, TempUnit.Celsius));
		expected.add(new DailyForecast(new Date(Month.Mar, 6), WeatherIcon.Raining.getStaticPath(), 11, 18, TempUnit.Celsius));
		
		assertEquals(expected, result);
			
	}

}
